services:
  # FIN Spring Boot Application
  fin-app:
    build:
      context: ./spring-app
      dockerfile: Dockerfile.spring-prebuilt
    container_name: fin-app
    environment:
      # Database Configuration (connects to host database)
      DATABASE_URL: jdbc:postgresql://host.docker.internal:5432/drimacc_db
      DATABASE_USER: ${DATABASE_USER:-postgres}
      DATABASE_PASSWORD: ${DATABASE_PASSWORD:-postgres}
      SPRING_DATASOURCE_URL: jdbc:postgresql://host.docker.internal:5432/drimacc_db
      SPRING_DATASOURCE_USERNAME: ${DATABASE_USER:-postgres}
      SPRING_DATASOURCE_PASSWORD: ${DATABASE_PASSWORD:-postgres}

      # Application Configuration
      JAVA_OPTS: "-Xmx1g -Xms512m -Dfin.license.autoconfirm=true"
      SPRING_PROFILES_ACTIVE: docker

      # CORS Configuration for frontend
      CORS_ALLOWED_ORIGINS: http://localhost:3000
    ports:
      - "8080:8080"
    networks:
      - fin-network
    restart: unless-stopped

networks:
  fin-network:
    driver: bridge